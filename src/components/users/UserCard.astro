---
import { getProfileLink } from "../../lib/user";
import { getDisplayName, getProfileHandle } from "../../lib/user";
import Avatar from "./Avatar.astro";
import FollowButton from "./FollowButton.astro";
import FollowList from "./FollowList.astro";

interface Props {
  profile: any;
  isFollowing: boolean;
}

const { profile, isFollowing } = Astro.props;
---

<div class="rounded-lg shadow-sm border p-6">
  <div class="flex items-start gap-4">
    <Avatar
      user={{
        username: profile.username,
        github_username: profile.github_username,
        github_avatar_url: profile.github_avatar_url,
        avatar_url: profile.avatar_url,
      }}
      size={64}
    />

    <div class="flex-1 min-w-0">
      <a
        href={getProfileLink(profile)}
        class="font-semibold hover:underline block truncate"
      >
        {getDisplayName(profile)}
      </a>
      <p class="text-sm text-[var(--subtext)] truncate">
        {getProfileHandle(profile)}
      </p>

      {
        profile.bio && (
          <p class="text-sm text-[var(--subtext)] mt-2 line-clamp-2">
            {profile.bio}
          </p>
        )
      }

      <div class="mt-3 flex gap-4 text-xs">
        <FollowList
          userId={profile.id}
          type="followers"
          count={profile.followers_count || 0}
        />
      </div>

      <FollowButton
        followingId={profile.id}
        isFollowing={isFollowing}
        fullWidth={true}
        class="mt-4 text-sm"
      />
    </div>
  </div>
</div>
